<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grade 10's TO-DO LIST</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
<link rel="icon" href="scihi.png" type="image/png">
<style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #fff;
    }

#play-header {
  width: 1300px;
  height: auto;
  cursor: pointer;
  display: block;
  margin: 0 auto 10px auto;
  user-select: none;
  max-width: none;
}

.container {
  width: 100%;
  max-width: 1300px;
  margin: 0 auto;
  overflow-x: visible;
}

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      table-layout: fixed;
      min-width: 850px;
    }

    th, td {
      padding: 6px 8px;
      border: 1px solid #ccc;
      vertical-align: middle;
      word-break: break-word;
      height: 42px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-align: center;
      font-size: 18px;
      user-select: none;
    }

    th {
      background-color: #e0e0e0;
      font-weight: 600;
    }

    th:nth-child(1),
    td.number-cell {
      width: 60px;
      font-weight: 600;
      font-size: 14px;
      white-space: nowrap;
    }

    th:nth-child(2),
    td.subject-cell {
      width: 240px;
      white-space: normal;
      text-align: center;
      position: relative;
    }

    th:nth-child(3),
    td.notes-cell {
      width: 320px;
      max-width: 320px;
      text-align: center;
      white-space: nowrap;
    }

    .notes-cell {
      vertical-align: middle;
      padding: 2px 8px;
      height: 42px;
    }

    .notes-cell .editable-div {
      height: 38px;
      line-height: 38px;
      padding: 0 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
      font-family: 'Poppins', sans-serif;
      font-weight: normal; 
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      background-color: transparent;
      box-sizing: border-box;
    }

    th:nth-child(4),
    td.date-cell {
      width: 180px;
      white-space: nowrap;
      text-align: center;
    }

    th:nth-child(5),
    td.progress-cell {
      width: 200px;
      font-size: 18px;
      cursor: pointer;
      user-select: none;
      text-align: center;
      vertical-align: middle;
    }

    .progress-emoji {
      font-size: 18px !important;
      user-select: none;
      cursor: pointer;
      display: inline-block;
    }

    select.subject-main,
    select.subject-branch {
      font-weight: 600 !important;
      font-size: 14px;
      height: 38px;
      padding: 0 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      text-align-last: center;
      color: black;
      appearance: none;
      width: 100%;
      background-color: white;
      box-sizing: border-box;
    }

.subject-cell select.subject-main.mapeh-selected {
  width: 65%;
  display: inline-block;
  vertical-align: middle;
  margin-right: 2%;
}

.subject-cell select.subject-branch.mapeh-visible {
  width: 33%;
  display: inline-block;
  vertical-align: middle;
  background-color: #ffffcc;
}

    select option {
      text-align: center;
      color: black;
      background-color: white;
      white-space: normal;
      font-weight: 600;
      font-family: 'Poppins', sans-serif;
    }

    .editable-div {
      width: 100%;
      padding: 6px 8px;
      height: 38px;
      line-height: 1.4;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
      background-color: transparent;
      text-align: center;
      font-family: 'Poppins', sans-serif;
      font-weight: 400 !important;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      box-sizing: border-box;
    }

    input[type="date"] {
      background: none;
      width: 100%;
      height: 38px;
      font-size: 14px;
      font-family: 'Poppins', sans-serif;
      text-align: center;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      padding: 6px 8px;
    }

    tr.progress-red { background-color: #ffe5e5 !important; }
    tr.progress-yellow { background-color: #fffde5 !important; }
    tr.progress-green { background-color: #e5ffe5 !important; }

    tr.remove-mode-hover {
      outline: 3px solid #ff3333;
      outline-offset: -3px;
      cursor: pointer;
    }

    tbody:not(.remove-mode) tr:hover {
      background-color: #f9f9f9;
    }

    .buttons-container {
      display: flex;
      justify-content: flex-start;
      gap: 10px;
      margin-top: 20px;
    }

    .buttons-container button {
      padding: 8px 16px;
      font-size: 14px;
      cursor: pointer;
      border-radius: 6px;
      border: 1.5px solid black;
      background-color: white;
      color: black;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
    }

    .buttons-container button:hover {
      background-color: #f0f0f0;
    }
</style>
</head>
<body>

  <img src="header.png" id="play-header" alt="Header" />

  <div class="container">
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Subject</th>
          <th>Description &amp; Notes</th>
          <th>Date &amp; Deadline</th>
          <th>Progress</th>
        </tr>
      </thead>
      <tbody id="tasks-tbody"></tbody>
    </table>

    <div class="buttons-container">
      <button id="add-task-btn">Add Task</button>
      <button id="remove-task-btn">Remove Task</button>
    </div>
  </div>

  <script>
  const subjects = [
    { name: "", color: "#ffffff" },
    { name: "English", color: "#cce6ff" },
    { name: "Filipino", color: "#b3ecb3" },
    { name: "Mathematics", color: "#99cc99" },
    { name: "A.P.", color: "#ff9999" },
    { name: "Electronics", color: "#b399cc" },
    { name: "C.A.T.", color: "#cc9966" },
    { name: "Science", color: "#ffcc80" },
    { name: "Research", color: "#99bbff" },
    { name: "Journalism", color: "#b3b3b3" },
    { name: "E.S.P.", color: "#fbe4d6" },
    { name: "MAPEH", color: "#ffffcc" }
  ];

  const mapehBranches = ["Music", "Arts", "P.E.", "Health"];
  const tasksTbody = document.getElementById("tasks-tbody");
  const addTaskBtn = document.getElementById("add-task-btn");
  const removeTaskBtn = document.getElementById("remove-task-btn");
  let removeMode = false;

  const progressEmojis = {
    white: "⬜",
    x: "❌",
    yellow: "⏳",
    check: "✅",
  };

  function createSubjectSelect(selectedSubject) {
    const select = document.createElement("select");
    select.className = "subject-main";

    subjects.forEach(({ name, color }) => {
      const option = document.createElement("option");
      option.value = name;
      option.textContent = name;
      option.style.backgroundColor = "white";
      if (name === selectedSubject) option.selected = true;
      select.appendChild(option);
    });

    select.addEventListener("change", () => {
      let row = select.closest("tr");
      if (!row) return;

      if (select.value === "MAPEH") {
  select.classList.add("mapeh-selected");
  if (!row.querySelector(".subject-branch")) {
    const branchSelect = document.createElement("select");
    branchSelect.className = "subject-branch mapeh-visible";
    mapehBranches.forEach(branch => {
      const option = document.createElement("option");
      option.value = branch;
      option.textContent = branch;
      branchSelect.appendChild(option);
    });
    row.querySelector(".subject-cell").appendChild(branchSelect);
  }
} else {
  select.classList.remove("mapeh-selected");
  const branchSelect = row.querySelector(".subject-branch");
  if (branchSelect) branchSelect.remove();
}
      updateSubjectColors(row);
      saveTasks();
    });

    return select;
  }

  function createRow(task = {}) {
    const row = document.createElement("tr");

    const numberCell = document.createElement("td");
    numberCell.className = "number-cell";
    numberCell.textContent = "";
    row.appendChild(numberCell);

    const subjectCell = document.createElement("td");
    subjectCell.className = "subject-cell";
    const subjectSelect = createSubjectSelect(task.subjectMain || "");
    subjectCell.appendChild(subjectSelect);

    if (task.subjectMain === "MAPEH" && task.subjectBranch) {
      const branchSelect = document.createElement("select");
      branchSelect.className = "subject-branch mapeh-visible";
      mapehBranches.forEach(branch => {
        const option = document.createElement("option");
        option.value = branch;
        option.textContent = branch;
        if (branch === task.subjectBranch) option.selected = true;
        branchSelect.appendChild(option);
      });
      subjectCell.appendChild(branchSelect);
      branchSelect.addEventListener("change", () => saveTasks());
    }

    subjectSelect.addEventListener("change", () => saveTasks());
    row.appendChild(subjectCell);

    const notesCell = document.createElement("td");
    notesCell.className = "notes-cell";
    const editableDiv = document.createElement("div");
    editableDiv.className = "editable-div";
    editableDiv.contentEditable = true;
    editableDiv.textContent = task.notes || "";
    editableDiv.spellcheck = false;
    editableDiv.addEventListener("input", () => saveTasks());
    notesCell.appendChild(editableDiv);
    row.appendChild(notesCell);

    const dateCell = document.createElement("td");
    dateCell.className = "date-cell";
    const dateInput = document.createElement("input");
    dateInput.type = "date";
    dateInput.value = task.date || "";
    dateInput.addEventListener("change", () => saveTasks());
    dateCell.appendChild(dateInput);
    row.appendChild(dateCell);

    const progressCell = document.createElement("td");
    progressCell.className = "progress-cell";
    const progressEmojisCycle = ["white", "x", "yellow", "check"];
    let currentIndex = task.progress ? progressEmojisCycle.indexOf(task.progress) : 0;
    if (currentIndex === -1) currentIndex = 0;

    function updateProgress() {
      const emojiKey = progressEmojisCycle[currentIndex];
      progressCell.textContent = progressEmojis[emojiKey];
      row.classList.remove("progress-red", "progress-yellow", "progress-green");
      if (emojiKey === "x") row.classList.add("progress-red");
      else if (emojiKey === "yellow") row.classList.add("progress-yellow");
      else if (emojiKey === "check") row.classList.add("progress-green");
    }

    updateProgress();
    progressCell.addEventListener("click", () => {
      currentIndex = (currentIndex + 1) % progressEmojisCycle.length;
      updateProgress();
      saveTasks();
    });
    row.appendChild(progressCell);

    row.addEventListener("mouseenter", () => {
      if (removeMode) row.classList.add("remove-mode-hover");
    });
    row.addEventListener("mouseleave", () => {
      if (removeMode) row.classList.remove("remove-mode-hover");
    });
    row.addEventListener("click", () => {
      if (removeMode) {
        row.remove();
        updateRowNumbers();
        saveTasks();
      }
    });

    updateSubjectColors(row);
    return row;
  }

  function updateRowNumbers() {
    const rows = tasksTbody.querySelectorAll("tr");
    rows.forEach((row, i) => {
      const numberCell = row.querySelector(".number-cell");
      numberCell.textContent = (i + 1).toString();
    });
  }

  function updateSubjectColors(row) {
    const subjectSelect = row.querySelector("select.subject-main");
    if (!subjectSelect) return;
    const subjectName = subjectSelect.value;
    const subjectData = subjects.find(s => s.name === subjectName);
    subjectSelect.style.backgroundColor = subjectData?.color || "white";
    row.style.backgroundColor = "white";
    const branchSelect = row.querySelector("select.subject-branch");
    if (branchSelect) {
      branchSelect.style.backgroundColor = "#ffffcc";
    }
  }

  function saveTasks() {
    const rows = tasksTbody.querySelectorAll("tr");
    const tasks = [];
    rows.forEach(row => {
      const subjectSelect = row.querySelector("select.subject-main");
      const branchSelect = row.querySelector("select.subject-branch");
      const notesDiv = row.querySelector(".editable-div");
      const dateInput = row.querySelector("input[type=date]");
      const progressCell = row.querySelector(".progress-cell");

      if (!subjectSelect || !notesDiv || !dateInput || !progressCell) return;

      const emoji = progressCell.textContent;
      const progressKey = Object.entries(progressEmojis).find(([key, val]) => val === emoji)?.[0] || "white";

      tasks.push({
        subjectMain: subjectSelect.value,
        subjectBranch: branchSelect ? branchSelect.value : null,
        notes: notesDiv.textContent,
        date: dateInput.value,
        progress: progressKey,
      });
    });
    localStorage.setItem("todoTasks", JSON.stringify(tasks));
  }

  function loadTasks() {
    const saved = localStorage.getItem("todoTasks");
    tasksTbody.innerHTML = "";
    if (saved) {
      try {
        const tasks = JSON.parse(saved);
        if (tasks.length === 0) {
          tasksTbody.appendChild(createRow());
        } else {
          tasks.forEach(task => {
            tasksTbody.appendChild(createRow(task));
          });
        }
      } catch (e) {
        console.error("Failed to parse saved tasks:", e);
        tasksTbody.appendChild(createRow());
      }
    } else {
      tasksTbody.appendChild(createRow());
    }
    updateRowNumbers();
  }

  addTaskBtn.addEventListener("click", () => {
    tasksTbody.appendChild(createRow());
    updateRowNumbers();
    saveTasks();
  });

  removeTaskBtn.addEventListener("click", () => {
    removeMode = !removeMode;
    tasksTbody.classList.toggle("remove-mode", removeMode);
    removeTaskBtn.style.backgroundColor = removeMode ? "#ffcccc" : "";
  });

  // --- Audio playback on header click ---
  const audioFiles = ["coconutmall.mp3", "subwaysurfers.mp3", "minuet.mp3", "lmfftclap.mp3"];
  let audio = new Audio();

  document.getElementById("play-header").addEventListener("click", () => {
    const randomSrc = audioFiles[Math.floor(Math.random() * audioFiles.length)];
    audio.src = randomSrc;
    audio.play().catch(e => console.log("Audio play failed:", e));
  });

  // Initial load
  loadTasks();

function updateRowNumbers() {
  const rows = tasksTbody.querySelectorAll("tr");
  rows.forEach((row, i) => {
    const numberCell = row.querySelector(".number-cell");
    numberCell.textContent = String(i + 1).padStart(3, '0');
  });
}
  </script>

</body>
</html>
